<div
  class="loader-container"
  *ngIf="plans.length === 0; else subscriptionContent"
>
  <app-loader></app-loader>
</div>
<ng-template #subscriptionContent>
  <div class="container mt-4">
    <div class="row justify-content-end">
      <div class="col-sm-12 col-md-10 col-lg-4 col-xl-4">
        <div class="d-flex justify-content-end me-2">
          <i class="bi bi-gear-fill fs-3" (click)="openSettings()"></i>
        </div>
      </div>
    </div>
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-10 col-lg-4 col-xl-4">
        <h2 class="fw-bold text-center">First 14 days free</h2>
        <h4 class="text-center">
          Elevate your happiness journey with TrulyHappy!
        </h4>
        <div class="mx-auto d-flex justify-content-center mt-3">
          <img src="/assets/icons/happy_sun.svg" style="width: 60px" />
        </div>
      </div>
    </div>
    <div class="row justify-content-center m-3" *ngFor="let feature of content">
      <div
        class="col-sm-12 col-md-10 col-lg-4 col-xl-4 d-flex align-items-start"
      >
        <img
          [src]="feature.icon"
          alt="icon"
          class="img-fluid"
          height="30"
          width="30"
        />
        <div class="mx-2">
          <h5 class="fw-medium">{{ feature.title }}</h5>
          <span class="text-muted">{{ feature.description }}</span>
        </div>
      </div>
    </div>
    <div class="row justify-content-center mb-4">
      <div class="col-sm-12 col-md-10 col-lg-4 col-xl-4">
        <div class="plans">
          <div
            *ngFor="let plan of plans"
            class="plan rounded-3 p-2 mb-2 position-relative"
            [ngClass]="{ 'plan-selected': plan.id === selectedPlan?.id }"
            (click)="selectPlan(plan)"
          >
            <div *ngIf="plan.id === bestValuePlan?.id" class="best-value">
              Best Value
            </div>
            <h6 class="fw-bold">{{ plan.name }}</h6>
            <span>{{ formatPlanDescription(plan) }}</span>
            <span *ngIf="plan.id === bestValuePlan?.id">
              ({{ bestValuePlanMonthlyPrice }})</span
            >
          </div>
        </div>
        <div class="text-center my-3 small" *ngIf="isForCheckout">
          <a href="/terms-of-use" target="_blank" class="text-decoration-none"
            >Terms & Conditions</a
          >
        </div>
        <div class="d-flex flex-column w-100 mt-3">
          <button
            (click)="subscribe()"
            [disabled]="isCreatingCheckoutUrl"
            class="btn btn-warning p-3 rounded-pill fw-semibold w-100 fs-6"
            [ngClass]="{ 'p-0': isCreatingCheckoutUrl }"
          >
            <span *ngIf="!isCreatingCheckoutUrl">{{ ctaLabel }}</span>
            <div
              *ngIf="isCreatingCheckoutUrl"
              class="d-flex justify-content-center p-0"
            >
              <app-loader [size]="25"></app-loader>
              <span class="ms-2">Processing...</span>
            </div>
          </button>
          <small *ngIf="isForCheckout" class="text-center mt-2"
            >Cancel anytime in settings</small
          >
        </div>
      </div>
    </div>
  </div>
</ng-template>
